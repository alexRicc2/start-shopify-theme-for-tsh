{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}
{{ 'newsletter-section.css' | asset_url | stylesheet_tag }}
{%- style -%}
  .wrapper{
    max-width: 900px;
    margin: auto;
  }
  .post_image{
    max-width: 100%;
    object-fit: contain;
  }
{%- endstyle -%}

  <div class="article-template__content page-width page-width--narrow rte">
    {% assign article_to_display =  request.path | split: '/' | last %}
    {% for article in blog.articles %}
      {% assign current_article = article.handle | split: '/' | last %}
      {% if current_article == article_to_display %}
        <img src="{{ article| image_url }}" height="500px" width="100%" alt="{{ article.image.alt }}" class="post_image" style="aspect-ratio: {{ article.image.aspect_ratio }}"/>
        <h1>{{ article.title }}</h1>
        <time>{{ article.published_at | date: '%B %d, %Y' }}</time>
         <div id="table-of-contents">
        <h2>Table of Contents</h2>
        <ul>
          {% assign headings = article.content | split: '<h' %}
          {% for heading in headings %}
            {% assign level = heading | split: '>' | first | remove: '</h' | plus: 0 %}
            {% if level > 0 and level <= 4 %}
              {% assign title = heading | split: '</h' | last | strip %}
              <li><a href="#{{ title | slugify }}">{{ title }}</a></li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
        <div id="post-content">
          {{article.content}}
        </div>
      {% endif %}
   {% endfor %}
<!--     <div class="ml-embedded" data-form="wicNzF"></div>  -->
    <div class="klaviyo-form-S6kpfw"></div>
  </div>


<!-- End MailerLite Universal -->
<script>
  const parentElement = document.querySelector('#post-content')
  const childCount = parentElement.children.length
  if(childCount >= 4){

    const insertIndex = Math.floor(childCount / 2)
    const newElement = document.createElement('div')
    newElement.className = "klaviyo-form-S6kpfw";
    // newElement.setAttribute("data-form", "wicNzF");
    
    parentElement.insertBefore(newElement, parentElement.children[insertIndex]);
    }
    
</script>

{% schema %}
{
  "name": "post blog",
  "settings": [],
  "presets": [
    {
      "name": "postblog"
    }
  ]
}
{% endschema %}
